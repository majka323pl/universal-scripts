local player = game.Players.LocalPlayer
local UserInputService = game:GetService("UserInputService")
local MarketplaceService = game:GetService("MarketplaceService")
local StarterGui = game:GetService("StarterGui")
local RunService = game:GetService("RunService")
local TeleportService = game:GetService("TeleportService")

-- WAŻNE: Upewnij się, że te ID są POPRAWNE!
local GAMEPASS_ID = 1296972626
local MM2_EXPERIENCE_ID = 142823291
local GAG_EXPERIENCE_ID = 9262276941 -- Zakładam, że to ID gry "Goofy Ahh Game"
local TELEPORT_PLACE_ID = 6557073879 -- Id gry, do której teleportuje (opcjonalne, na wypadek braku gamepassa)

local hasGamePass = false
local initialGamePassCheckDone = false -- Kontrola dla pierwszego powiadomienia o Game Passie

-- Funkcja do wysyłania powiadomień systemowych Roblox
local function sendNotification(title, text, duration)
    local success, err = pcall(function()
        StarterGui:SetCore("SendNotification", {
            Title = title,
            Text = text,
            Icon = "rbxassetid://102860171689689", -- Użyj swojej ikony
            Duration = duration or 5
        })
    end)
    if not success then
        warn("Nie udało się wysłać powiadomienia:", err)
    end
end

--- Tworzenie GUI ---

-- ScreenGui
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "UniversalScriptsGUI"
ScreenGui.Parent = player:WaitForChild("PlayerGui")
ScreenGui.ResetOnSpawn = false
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ScreenGui.Enabled = true

-- MainFrame (główne okno GUI)
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.Size = UDim2.new(0.6, 0, 0.7, 0) -- Proporcjonalny rozmiar (60% szerokości, 70% wysokości ekranu)
MainFrame.Position = UDim2.new(0.2, 0, 0.15, 0) -- Wyśrodkowanie na ekranie
MainFrame.BackgroundColor3 = Color3.fromRGB(44, 44, 44)
MainFrame.BorderSizePixel = 0
MainFrame.Active = true
MainFrame.Draggable = true
MainFrame.Visible = true

local MainFrameCorner = Instance.new("UICorner")
MainFrameCorner.CornerRadius = UDim.new(0, 10)
MainFrameCorner.Parent = MainFrame

-- UIListLayout dla MainFrame, aby ułożyć TitleLabel i TabsAndContentWrapper pionowo
local MainFrameLayout = Instance.new("UIListLayout")
MainFrameLayout.Parent = MainFrame
MainFrameLayout.FillDirection = Enum.FillDirection.Vertical
MainFrameLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
MainFrameLayout.SortOrder = Enum.SortOrder.LayoutOrder
MainFrameLayout.Padding = UDim.new(0, 0)

-- TitleLabel
local TitleLabel = Instance.new("TextLabel")
TitleLabel.Name = "TitleLabel"
TitleLabel.Parent = MainFrame
TitleLabel.Size = UDim2.new(1, 0, 0.1, 0) -- 10% wysokości MainFrame
TitleLabel.BackgroundTransparency = 0
TitleLabel.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
TitleLabel.Text = "UNIVERSAL SCRIPTS"
TitleLabel.Font = Enum.Font.LuckiestGuy
TitleLabel.TextColor3 = Color3.new(1, 1, 1)
TitleLabel.TextScaled = true
TitleLabel.BorderSizePixel = 0
TitleLabel.LayoutOrder = 1

local TitleLabelCorner = Instance.new("UICorner")
TitleLabelCorner.CornerRadius = UDim.new(0, 10)
TitleLabelCorner.Parent = TitleLabel

-- Frame to hold TabsFrame and ContentFrame horizontally
local TabsAndContentWrapper = Instance.new("Frame")
TabsAndContentWrapper.Name = "TabsAndContentWrapper"
TabsAndContentWrapper.Parent = MainFrame
TabsAndContentWrapper.Size = UDim2.new(1, 0, 0.9, 0) -- Reszta wysokości MainFrame
TabsAndContentWrapper.BackgroundTransparency = 1
TabsAndContentWrapper.BorderSizePixel = 0
TabsAndContentWrapper.LayoutOrder = 2

local TabsAndContentLayout = Instance.new("UIListLayout")
TabsAndContentLayout.Parent = TabsAndContentWrapper
TabsAndContentLayout.FillDirection = Enum.FillDirection.Horizontal
TabsAndContentLayout.HorizontalAlignment = Enum.HorizontalAlignment.Left
TabsAndContentLayout.SortOrder = Enum.SortOrder.LayoutOrder
TabsAndContentLayout.Padding = UDim.new(0, 0)

-- TabsFrame (ramka na przyciski zakładek)
local TabsFrame = Instance.new("Frame")
TabsFrame.Name = "TabsFrame"
TabsFrame.Parent = TabsAndContentWrapper
TabsFrame.Size = UDim2.new(0.25, 0, 1, 0) -- 25% szerokości wrappera, cała wysokość wrappera
TabsFrame.BackgroundColor3 = Color3.fromRGB(36, 36, 36)
TabsFrame.BorderSizePixel = 0
TabsFrame.Active = true
TabsFrame.LayoutOrder = 1

local TabsFrameCorner = Instance.new("UICorner")
TabsFrameCorner.CornerRadius = UDim.new(0, 10)
TabsFrameCorner.Parent = TabsFrame

-- Layout dla przycisków zakładek w TabsFrame
local TabsLayout = Instance.new("UIListLayout")
TabsLayout.Parent = TabsFrame
TabsLayout.FillDirection = Enum.FillDirection.Vertical
TabsLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
TabsLayout.Padding = UDim.new(0.02, 0) -- 2% odstępu między przyciskami
TabsLayout.SortOrder = Enum.SortOrder.LayoutOrder

-- HomeTabButton
local HomeTabButton = Instance.new("TextButton")
HomeTabButton.Name = "HomeTabButton"
HomeTabButton.Parent = TabsFrame
HomeTabButton.Size = UDim2.new(0.9, 0, 0.1, 0) -- Proporcjonalny rozmiar
HomeTabButton.Text = "Home"
HomeTabButton.Font = Enum.Font.SourceSans
HomeTabButton.TextScaled = true
HomeTabButton.TextColor3 = Color3.new(0, 0, 0)
HomeTabButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70) -- Domyślnie podświetlony
HomeTabButton.BorderSizePixel = 0
HomeTabButton.LayoutOrder = 1
Instance.new("UICorner", HomeTabButton).CornerRadius = UDim.new(0, 5)

-- PremiumTabButton
local PremiumTabButton = Instance.new("TextButton")
PremiumTabButton.Name = "PremiumTabButton"
PremiumTabButton.Parent = TabsFrame
PremiumTabButton.Size = UDim2.new(0.9, 0, 0.1, 0)
PremiumTabButton.Text = "Premium"
PremiumTabButton.Font = Enum.Font.SourceSans
PremiumTabButton.TextScaled = true
PremiumTabButton.TextColor3 = Color3.new(0, 0, 0)
PremiumTabButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
PremiumTabButton.BorderSizePixel = 0
PremiumTabButton.LayoutOrder = 2
Instance.new("UICorner", PremiumTabButton).CornerRadius = UDim.new(0, 5)

-- ExecutorTabButton (NOWA ZAKŁADKA)
local ExecutorTabButton = Instance.new("TextButton")
ExecutorTabButton.Name = "ExecutorTabButton"
ExecutorTabButton.Parent = TabsFrame
ExecutorTabButton.Size = UDim2.new(0.9, 0, 0.1, 0)
ExecutorTabButton.Text = "Executor"
ExecutorTabButton.Font = Enum.Font.SourceSans
ExecutorTabButton.TextScaled = true
ExecutorTabButton.TextColor3 = Color3.new(0, 0, 0)
ExecutorTabButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
ExecutorTabButton.BorderSizePixel = 0
ExecutorTabButton.LayoutOrder = 3
Instance.new("UICorner", ExecutorTabButton).CornerRadius = UDim.new(0, 5)

-- ContentFrame (ramka na zawartość zakładek)
local ContentFrame = Instance.new("Frame")
ContentFrame.Name = "ContentFrame"
ContentFrame.Parent = TabsAndContentWrapper
ContentFrame.Size = UDim2.new(0.75, 0, 1, 0) -- 75% szerokości wrappera, cała wysokość wrappera
ContentFrame.BackgroundColor3 = Color3.fromRGB(59, 59, 59)
ContentFrame.BorderSizePixel = 0
ContentFrame.Active = true
ContentFrame.LayoutOrder = 2
Instance.new("UICorner", ContentFrame).CornerRadius = UDim.new(0, 10)

-- ScrollingFrame dla Home
local ScrollingFrameHome = Instance.new("ScrollingFrame")
ScrollingFrameHome.Name = "ScrollingFrameHome"
ScrollingFrameHome.Parent = ContentFrame
ScrollingFrameHome.Size = UDim2.new(1, 0, 1, 0) -- Wypełnia ContentFrame
ScrollingFrameHome.BackgroundColor3 = Color3.fromRGB(59, 59, 59)
ScrollingFrameHome.BorderSizePixel = 0
ScrollingFrameHome.ScrollingDirection = Enum.ScrollingDirection.Y
ScrollingFrameHome.Active = true
ScrollingFrameHome.Visible = true -- Domyślnie widoczny
Instance.new("UICorner", ScrollingFrameHome).CornerRadius = UDim.new(0, 8)

local HomeGridLayout = Instance.new("UIGridLayout")
HomeGridLayout.Parent = ScrollingFrameHome
HomeGridLayout.StartCorner = Enum.StartCorner.TopLeft
HomeGridLayout.FillDirection = Enum.FillDirection.Horizontal
HomeGridLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
HomeGridLayout.VerticalAlignment = Enum.VerticalAlignment.Top
HomeGridLayout.CellSize = UDim2.new(0.45, 0, 0.15, 0) -- Rozmiar komórki w proporcji do rozmiaru ScrollingFrameHome
HomeGridLayout.CellPadding = UDim.new(0.02, 0, 0.02, 0) -- Proporcjonalne odstępy

-- Przyciski dla Home
local SpeedToolbutton = Instance.new("TextButton")
SpeedToolbutton.Name = "Speed Tool"
SpeedToolbutton.Parent = ScrollingFrameHome
SpeedToolbutton.Size = UDim2.new(1, 0, 1, 0)
SpeedToolbutton.Text = "Speed Tool"
SpeedToolbutton.Font = Enum.Font.SourceSans
SpeedToolbutton.TextScaled = true
SpeedToolbutton.TextColor3 = Color3.new(0, 0, 0)
SpeedToolbutton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
SpeedToolbutton.BorderSizePixel = 0
Instance.new("UICorner", SpeedToolbutton).CornerRadius = UDim.new(0, 5)

local ClicktptoolButton = Instance.new("TextButton")
ClicktptoolButton.Name = "Click tp tool"
ClicktptoolButton.Parent = ScrollingFrameHome
ClicktptoolButton.Size = UDim2.new(1, 0, 1, 0)
ClicktptoolButton.Text = "Click tp tool"
ClicktptoolButton.Font = Enum.Font.SourceSans
ClicktptoolButton.TextScaled = true
ClicktptoolButton.TextColor3 = Color3.new(0, 0, 0)
ClicktptoolButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
ClicktptoolButton.BorderSizePixel = 0
Instance.new("UICorner", ClicktptoolButton).CornerRadius = UDim.new(0, 5)

local NoclipButton = Instance.new("TextButton")
NoclipButton.Name = "Noclip"
NoclipButton.Parent = ScrollingFrameHome
NoclipButton.Size = UDim2.new(1, 0, 1, 0)
NoclipButton.Text = "Noclip"
NoclipButton.Font = Enum.Font.SourceSans
NoclipButton.TextScaled = true
NoclipButton.TextColor3 = Color3.new(0, 0, 0)
NoclipButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
NoclipButton.BorderSizePixel = 0
Instance.new("UICorner", NoclipButton).CornerRadius = UDim.new(0, 5)

local InfinityJumpButton = Instance.new("TextButton")
InfinityJumpButton.Name = "Infinity Jump"
InfinityJumpButton.Parent = ScrollingFrameHome
InfinityJumpButton.Size = UDim2.new(1, 0, 1, 0)
InfinityJumpButton.Text = "Infinity Jump"
InfinityJumpButton.Font = Enum.Font.SourceSans
InfinityJumpButton.TextScaled = true
InfinityJumpButton.TextColor3 = Color3.new(0, 0, 0)
InfinityJumpButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
InfinityJumpButton.BorderSizePixel = 0
Instance.new("UICorner", InfinityJumpButton).CornerRadius = UDim.new(0, 5)

local AntiFlingButton = Instance.new("TextButton")
AntiFlingButton.Name = "Anti-Fling"
AntiFlingButton.Parent = ScrollingFrameHome
AntiFlingButton.Size = UDim2.new(1, 0, 1, 0)
AntiFlingButton.Text = "Anti-Fling"
AntiFlingButton.Font = Enum.Font.SourceSans
AntiFlingButton.TextScaled = true
AntiFlingButton.TextColor3 = Color3.new(0, 0, 0)
AntiFlingButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
AntiFlingButton.BorderSizePixel = 0
Instance.new("UICorner", AntiFlingButton).CornerRadius = UDim.new(0, 5)

local FlyButtonHome = Instance.new("TextButton")
FlyButtonHome.Name = "Fly (Home)"
FlyButtonHome.Parent = ScrollingFrameHome
FlyButtonHome.Size = UDim2.new(1, 0, 1, 0)
FlyButtonHome.Text = "Fly"
FlyButtonHome.Font = Enum.Font.SourceSans
FlyButtonHome.TextScaled = true
FlyButtonHome.TextColor3 = Color3.new(0, 0, 0)
FlyButtonHome.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
FlyButtonHome.BorderSizePixel = 0
Instance.new("UICorner", FlyButtonHome).CornerRadius = UDim.new(0, 5)

-- ScrollingFrame dla Premium
local ScrollingFramePremium = Instance.new("ScrollingFrame")
ScrollingFramePremium.Name = "ScrollingFramePremium"
ScrollingFramePremium.Parent = ContentFrame
ScrollingFramePremium.Size = UDim2.new(1, 0, 1, 0)
ScrollingFramePremium.BackgroundColor3 = Color3.fromRGB(59, 59, 59)
ScrollingFramePremium.BorderSizePixel = 0
ScrollingFramePremium.ScrollingDirection = Enum.ScrollingDirection.Y
ScrollingFramePremium.Active = true
ScrollingFramePremium.Visible = false
Instance.new("UICorner", ScrollingFramePremium).CornerRadius = UDim.new(0, 8)

local PremiumGridLayout = Instance.new("UIGridLayout")
PremiumGridLayout.Parent = ScrollingFramePremium
PremiumGridLayout.StartCorner = Enum.StartCorner.TopLeft
PremiumGridLayout.FillDirection = Enum.FillDirection.Horizontal
PremiumGridLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
PremiumGridLayout.VerticalAlignment = Enum.VerticalAlignment.Top
PremiumGridLayout.CellSize = UDim2.new(0.45, 0, 0.15, 0)
PremiumGridLayout.CellPadding = UDim.new(0.02, 0, 0.02, 0)

-- Przyciski dla Premium
local SpectateButton_Premium = Instance.new("TextButton")
SpectateButton_Premium.Name = "Spectate (Premium)"
SpectateButton_Premium.Parent = ScrollingFramePremium
SpectateButton_Premium.Size = UDim2.new(1, 0, 1, 0)
SpectateButton_Premium.Text = "Spectate"
SpectateButton_Premium.Font = Enum.Font.SourceSans
SpectateButton_Premium.TextScaled = true
SpectateButton_Premium.TextColor3 = Color3.new(0, 0, 0)
SpectateButton_Premium.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
SpectateButton_Premium.BorderSizePixel = 0
Instance.new("UICorner", SpectateButton_Premium).CornerRadius = UDim.new(0, 5)

local FlyButtonPremium = Instance.new("TextButton")
FlyButtonPremium.Name = "Console (Premium)"
FlyButtonPremium.Parent = ScrollingFramePremium
FlyButtonPremium.Size = UDim2.new(1, 0, 1, 0)
FlyButtonPremium.Text = "Console"
FlyButtonPremium.Font = Enum.Font.SourceSans
FlyButtonPremium.TextScaled = true
FlyButtonPremium.TextColor3 = Color3.new(0, 0, 0)
FlyButtonPremium.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
FlyButtonPremium.BorderSizePixel = 0
Instance.new("UICorner", FlyButtonPremium).CornerRadius = UDim.new(0, 5)

local Invisibiltybutton = Instance.new("TextButton")
Invisibiltybutton.Name = "Invisibilty"
Invisibiltybutton.Parent = ScrollingFramePremium
Invisibiltybutton.Size = UDim2.new(1, 0, 1, 0)
Invisibiltybutton.Text = "Invisibilty"
Invisibiltybutton.Font = Enum.Font.SourceSans
Invisibiltybutton.TextScaled = true
Invisibiltybutton.TextColor3 = Color3.new(0, 0, 0)
Invisibiltybutton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
Invisibiltybutton.BorderSizePixel = 0
Instance.new("UICorner", Invisibiltybutton).CornerRadius = UDim.new(0, 5)

local FlingButton_Premium = Instance.new("TextButton")
FlingButton_Premium.Name = "Fling (Premium)"
FlingButton_Premium.Parent = ScrollingFramePremium
FlingButton_Premium.Size = UDim2.new(1, 0, 1, 0)
FlingButton_Premium.Text = "Fling"
FlingButton_Premium.Font = Enum.Font.SourceSans
FlingButton_Premium.TextScaled = true
FlingButton_Premium.TextColor3 = Color3.new(0, 0, 0)
FlingButton_Premium.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
FlingButton_Premium.BorderSizePixel = 0
Instance.new("UICorner", FlingButton_Premium).CornerRadius = UDim.new(0, 5)

local MM2Button = Instance.new("TextButton")
MM2Button.Name = "MM2"
MM2Button.Parent = ScrollingFramePremium
MM2Button.Size = UDim2.new(1, 0, 1, 0)
MM2Button.Text = "MM2"
MM2Button.Font = Enum.Font.SourceSans
MM2Button.TextScaled = true
MM2Button.TextColor3 = Color3.new(0, 0, 0)
MM2Button.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
MM2Button.BorderSizePixel = 0
MM2Button.Visible = false -- Będzie widoczny tylko w MM2
Instance.new("UICorner", MM2Button).CornerRadius = UDim.new(0, 5)

local GhostMM2Button = Instance.new("TextButton")
GhostMM2Button.Name = "GhostMM2"
GhostMM2Button.Parent = ScrollingFramePremium
GhostMM2Button.Size = UDim2.new(1, 0, 1, 0)
GhostMM2Button.Text = "GhostMM2"
GhostMM2Button.Font = Enum.Font.SourceSans
GhostMM2Button.TextScaled = true
GhostMM2Button.TextColor3 = Color3.new(0, 0, 0)
GhostMM2Button.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
GhostMM2Button.BorderSizePixel = 0
GhostMM2Button.Visible = false -- Będzie widoczny tylko w MM2
Instance.new("UICorner", GhostMM2Button).CornerRadius = UDim.new(0, 5)

local GAGButton = Instance.new("TextButton")
GAGButton.Name = "GAG"
GAGButton.Parent = ScrollingFramePremium
GAGButton.Size = UDim2.new(1, 0, 1, 0)
GAGButton.Text = "GAG"
GAGButton.Font = Enum.Font.SourceSans
GAGButton.TextScaled = true
GAGButton.TextColor3 = Color3.new(0, 0, 0)
GAGButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
GAGButton.BorderSizePixel = 0
GAGButton.Visible = false -- Będzie widoczny tylko w Goofy Ahh Game
Instance.new("UICorner", GAGButton).CornerRadius = UDim.new(0, 5)

-- ExecutorFrame (NOWA RAMKA DLA EXECUTORA)
local ExecutorFrame = Instance.new("Frame")
ExecutorFrame.Name = "ExecutorFrame"
ExecutorFrame.Parent = ContentFrame
ExecutorFrame.Size = UDim2.new(1, 0, 1, 0)
ExecutorFrame.BackgroundColor3 = Color3.fromRGB(59, 59, 59)
ExecutorFrame.BorderSizePixel = 0
ExecutorFrame.Active = true
ExecutorFrame.Visible = false -- Domyślnie niewidoczny
Instance.new("UICorner", ExecutorFrame).CornerRadius = UDim.new(0, 8)

local ExecutorLayout = Instance.new("UIListLayout")
ExecutorLayout.Parent = ExecutorFrame
ExecutorLayout.FillDirection = Enum.FillDirection.Vertical
ExecutorLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
ExecutorLayout.Padding = UDim.new(0.01, 0)
ExecutorLayout.SortOrder = Enum.SortOrder.LayoutOrder

-- ExecutorTextBox
local ExecutorTextBox = Instance.new("TextBox")
ExecutorTextBox.Name = "ExecutorTextBox"
ExecutorTextBox.Parent = ExecutorFrame
ExecutorTextBox.Size = UDim2.new(0.96, 0, 0.8, 0) -- 80% wysokości ExecutorFrame
ExecutorTextBox.BackgroundColor3 = Color3.fromRGB(31, 31, 31)
ExecutorTextBox.BorderColor3 = Color3.fromRGB(34, 34, 34)
ExecutorTextBox.BorderSizePixel = 1
ExecutorTextBox.Font = Enum.Font.SourceSans
ExecutorTextBox.Text = "-- Wklej tutaj swój kod Lua"
ExecutorTextBox.TextColor3 = Color3.new(1, 1, 1)
ExecutorTextBox.TextSize = 18
ExecutorTextBox.TextWrapped = true
ExecutorTextBox.MultiLine = true -- Ważne dla wielu linii kodu
ExecutorTextBox.ClearTextOnFocus = true -- Wyczyść tekst po kliknięciu
ExecutorTextBox.LayoutOrder = 1
Instance.new("UICorner", ExecutorTextBox).CornerRadius = UDim.new(0, 5)

-- ExecutorButtonsFrame
local ExecutorButtonsFrame = Instance.new("Frame")
ExecutorButtonsFrame.Name = "ExecutorButtonsFrame"
ExecutorButtonsFrame.Parent = ExecutorFrame
ExecutorButtonsFrame.Size = UDim2.new(0.96, 0, 0.15, 0) -- 15% wysokości ExecutorFrame
ExecutorButtonsFrame.BackgroundColor3 = Color3.fromRGB(44, 44, 44)
ExecutorButtonsFrame.BorderSizePixel = 0
ExecutorButtonsFrame.LayoutOrder = 2
Instance.new("UICorner", ExecutorButtonsFrame).CornerRadius = UDim.new(0, 5)

local ExecutorButtonsLayout = Instance.new("UIListLayout")
ExecutorButtonsLayout.Parent = ExecutorButtonsFrame
ExecutorButtonsLayout.FillDirection = Enum.FillDirection.Horizontal
ExecutorButtonsLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
ExecutorButtonsLayout.Padding = UDim.new(0.02, 0)
ExecutorButtonsLayout.SortOrder = Enum.SortOrder.LayoutOrder

-- ExecuteButton
local ExecuteButton = Instance.new("TextButton")
ExecuteButton.Name = "ExecuteButton"
ExecuteButton.Parent = ExecutorButtonsFrame
ExecuteButton.Size = UDim2.new(0.45, 0, 0.8, 0) -- Proporcjonalny rozmiar wewnątrz ExecutorButtonsFrame
ExecuteButton.Text = "Execute"
ExecuteButton.Font = Enum.Font.SourceSans
ExecuteButton.TextScaled = true
ExecuteButton.TextColor3 = Color3.new(0, 0, 0)
ExecuteButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
ExecuteButton.BorderSizePixel = 0
Instance.new("UICorner", ExecuteButton).CornerRadius = UDim.new(0, 5)

-- ClearButton
local ClearButton = Instance.new("TextButton")
ClearButton.Name = "ClearButton"
ClearButton.Parent = ExecutorButtonsFrame
ClearButton.Size = UDim2.new(0.45, 0, 0.8, 0)
ClearButton.Text = "Clear"
ClearButton.Font = Enum.Font.SourceSans
ClearButton.TextScaled = true
ClearButton.TextColor3 = Color3.new(0, 0, 0)
ClearButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
ClearButton.BorderSizePixel = 0
Instance.new("UICorner", ClearButton).CornerRadius = UDim.new(0, 5)


-- HideButton (przycisk do ukrywania/pokazywania GUI)
local HideButton = Instance.new("ImageButton")
HideButton.Name = "HideButton"
HideButton.Parent = MainFrame -- Parent to MainFrame
HideButton.Size = UDim2.new(0, 30, 0, 30)
HideButton.Position = UDim2.new(1, -35, 0, 5)
HideButton.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
HideButton.Image = "rbxassetid://102860171689689" -- Ikona krzyżyka lub inna
HideButton.ImageColor3 = Color3.new(1, 1, 1)
HideButton.ScaleType = Enum.ScaleType.Fit
HideButton.BorderSizePixel = 3
HideButton.BorderColor3 = Color3.fromRGB(0, 0, 0)
HideButton.ZIndex = 5
HideButton.Active = true
HideButton.Draggable = false

--- Funkcje i logika skryptu ---

local function showTab(tabName)
    ScrollingFrameHome.Visible = false
    ScrollingFramePremium.Visible = false
    ExecutorFrame.Visible = false -- Ukryj ExecutorFrame

    -- Zresetuj kolory przycisków zakładek
    HomeTabButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    PremiumTabButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    ExecutorTabButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)

    if tabName == "Home" then
        ScrollingFrameHome.Visible = true
        HomeTabButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
    elseif tabName == "Premium" then
        local success, result = pcall(function()
            return MarketplaceService:UserOwnsGamePassAsync(player.UserId, GAMEPASS_ID)
        end)

        if success then
            hasGamePass = result
            if hasGamePass then
                ScrollingFramePremium.Visible = true
                PremiumTabButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
                if not initialGamePassCheckDone then
                    sendNotification("Universal Scripts", "Wersja premium aktywowana.")
                    initialGamePassCheckDone = true
                end
            else
                sendNotification("Universal Scripts", "Musisz posiadać wersję premium, aby uzyskać dostęp do tej zakładki!")
                MarketplaceService:PromptGamePassPurchase(player, GAMEPASS_ID)
            end
        else
            warn("Błąd podczas sprawdzania wersji premium (showTab):", result)
            sendNotification("Universal Scripts", "Nie można sprawdzić statusu wersji premium. Spróbuj ponownie.")
        end
    elseif tabName == "Executor" then -- NOWA LOGIKA DLA ZAKŁADKI EXECUTORA
        ExecutorFrame.Visible = true
        ExecutorTabButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
        sendNotification("Universal Scripts", "Przeszedłeś do zakładki Executor. Wklej kod i naciśnij Execute.")
    end
end

local function checkGamePassStatus()
    local success, result = pcall(function()
        return MarketplaceService:UserOwnsGamePassAsync(player.UserId, GAMEPASS_ID)
    end)

    if success then
        hasGamePass = result
        if not initialGamePassCheckDone then
            if hasGamePass then
                sendNotification("Universal Scripts", "Posiadasz wersję premium! Funkcje Premium odblokowane.")
            else
                sendNotification("Universal Scripts", "Nie posiadasz wersji premium. Kliknij zakładkę Premium, aby przejść do zakupu.")
            end
            initialGamePassCheckDone = true
        end
    else
        warn("Błąd podczas sprawdzania wersji premium (checkGamePassStatus):", result)
        sendNotification("Universal Scripts", "Nie można sprawdzić statusu wersji premium. Spróbuj ponownie.")
    end
end

local function updateSpecialButtonVisibility()
    local currentPlaceId = game.PlaceId
    
    -- Przyciski MM2 i GhostMM2
    if currentPlaceId == MM2_EXPERIENCE_ID then
        MM2Button.Visible = true
        GhostMM2Button.Visible = true
    else
        MM2Button.Visible = false
        GhostMM2Button.Visible = false
    end

    -- Przycisk GAG
    if currentPlaceId == GAG_EXPERIENCE_ID then
        GAGButton.Visible = true
    else
        GAGButton.Visible = false
    end
end

-- Funkcja do ładowania i uruchamiania skryptów z URL (dla przycisków Home/Premium)
local function runScriptAndNotify(url, buttonName)
    local scriptContent = nil
    local successHttpGet, errHttpGet = pcall(function()
        scriptContent = game:HttpGet(url)
    end)

    if not successHttpGet then
        sendNotification("Universal Scripts", "Błąd pobierania skryptu '" .. buttonName .. "': " .. tostring(errHttpGet))
        warn("Błąd HTTP pobierania skryptu '" .. buttonName .. "':", errHttpGet)
        return
    end

    if not scriptContent or #scriptContent == 0 then
        sendNotification("Universal Scripts", "Pobrany skrypt '" .. buttonName .. "' jest pusty lub nieprawidłowy.")
        warn("Pobrany skrypt '" .. buttonName .. "' jest pusty.")
        return
    end

    local func, loadErr = loadstring(scriptContent)
    if not func then
        sendNotification("Universal Scripts", "Błąd parsowania skryptu '" .. buttonName .. "': " .. tostring(loadErr))
        warn("Błąd loadstring dla skryptu '" .. buttonName .. "':", loadErr)
        return
    end

    local successRun, runErr = pcall(func)
    if successRun then
        sendNotification("Universal Scripts", "Skrypt '" .. buttonName .. "' załadowany i uruchomiony!")
    else
        sendNotification("Universal Scripts", "Błąd uruchamiania skryptu '" .. buttonName .. "': " .. tostring(runErr))
        warn("Błąd wykonania skryptu '" .. buttonName .. "':", runErr)
    end
end

--- Podpięcie zdarzeń ---

-- Tab Button Click Events
HomeTabButton.MouseButton1Click:Connect(function()
    showTab("Home")
end)

PremiumTabButton.MouseButton1Click:Connect(function()
    showTab("Premium")
end)

ExecutorTabButton.MouseButton1Click:Connect(function() -- NOWY EVENT DLA ZAKŁADKI EXECUTORA
    showTab("Executor")
end)

-- Hide/Show GUI
HideButton.MouseButton1Click:Connect(function()
    MainFrame.Visible = not MainFrame.Visible
end)

-- Event Listeners for Home Tab Buttons
SpeedToolbutton.MouseButton1Click:Connect(function()
    runScriptAndNotify("https://pastebin.com/raw/X7B0HPc2", SpeedToolbutton.Text)
end)

ClicktptoolButton.MouseButton1Click:Connect(function()
    runScriptAndNotify("https://pastebin.com/raw/4KF2WJ9u", ClicktptoolButton.Text)
end)

NoclipButton.MouseButton1Click:Connect(function()
    runScriptAndNotify("https://pastebin.com/raw/CnbYfaj1", NoclipButton.Text)
end)

InfinityJumpButton.MouseButton1Click:Connect(function()
    runScriptAndNotify("https://pastebin.com/raw/J92bB0fP", InfinityJumpButton.Text) -- Przykładowy URL
end)

AntiFlingButton.MouseButton1Click:Connect(function()
    runScriptAndNotify("https://pastebin.com/raw/EXAMPLE_ANTIFLING_URL", AntiFlingButton.Text) -- ZMIEŃ NA WŁAŚCIWY URL!
end)

FlyButtonHome.MouseButton1Click:Connect(function()
    runScriptAndNotify("https://pastebin.com/raw/EXAMPLE_FLY_HOME_URL", FlyButtonHome.Text) -- ZMIEŃ NA WŁAŚCIWY URL!
end)

-- Event Listeners for Premium Tab Buttons (wraz ze sprawdzaniem GamePassa)
local function runPremiumScript(url, buttonName)
    local success, currentHasGamePass = pcall(function()
        return MarketplaceService:UserOwnsGamePassAsync(player.UserId, GAMEPASS_ID)
    end)

    if success then
        if currentHasGamePass then
            runScriptAndNotify(url, buttonName)
        else
            sendNotification("Universal Scripts", "Musisz posiadać wersję premium, aby użyć tej funkcji!")
            MarketplaceService:PromptGamePassPurchase(player, GAMEPASS_ID)
        end
    else
        warn("Błąd podczas sprawdzania wersji premium (" .. buttonName .. "):", currentHasGamePass)
        sendNotification("Universal Scripts", "Wystąpił błąd podczas sprawdzania wersji premium.")
    end
end

SpectateButton_Premium.MouseButton1Click:Connect(function()
    runPremiumScript("https://pastebin.com/raw/UFVLWQRw", SpectateButton_Premium.Text)
end)

FlyButtonPremium.MouseButton1Click:Connect(function()
    runPremiumScript("https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source", FlyButtonPremium.Text)
end)

Invisibiltybutton.MouseButton1Click:Connect(function()
    runPremiumScript('https://pastebin.com/raw/3Rnd9rHf', Invisibiltybutton.Text)
end)

FlingButton_Premium.MouseButton1Click:Connect(function()
    runPremiumScript('https://raw.githubusercontent.com/0Ben1/fe/main/obf_rf6iQURzu1fqrytcnLBAvW34C9N55kS9g9G3CKz086rC47M6632sEd4ZZYB0AYgV.lua.txt', FlingButton_Premium.Text)
end)

MM2Button.MouseButton1Click:Connect(function()
    runPremiumScript("https://raw.githubusercontent.com/vertex-peak/vertex/refs/heads/main/loadstring", MM2Button.Text)
end)

GhostMM2Button.MouseButton1Click:Connect(function()
    runPremiumScript("https://raw.githubusercontent.com/GhostPlayer352/Test4/main/Murder%20Mystery", GhostMM2Button.Text)
end)

GAGButton.MouseButton1Click:Connect(function()
    runPremiumScript("https://pastebin.com/raw/EXAMPLE_GAG_SCRIPT_URL", GAGButton.Text) -- ZMIEŃ NA WŁAŚCIWY URL!
end)

-- Executor Buttons Logic (NOWA LOGIKA)
ExecuteButton.MouseButton1Click:Connect(function()
    local codeToExecute = ExecutorTextBox.Text -- Pobierz tekst (kod) z pola tekstowego

    if codeToExecute and codeToExecute ~= "" then
        local success, errorMessage = pcall(function()
            local func = loadstring(codeToExecute) -- Kompiluje tekst jako funkcję Lua

            if func then
                func()
                sendNotification("Executor", "Kod wykonany pomyślnie!", 3)
            else
                sendNotification("Executor", "Błąd składni w kodzie. Sprawdź konsolę Output.", 8)
                warn("Błąd składni w kodzie (loadstring):", errorMessage)
            end
        end)

        if not success then
            sendNotification("Executor", "Wystąpił błąd podczas wykonywania kodu. Sprawdź konsolę Output.", 8)
            warn("Błąd podczas wykonywania kodu:", errorMessage)
        end
    else
        sendNotification("Executor", "Pole tekstowe jest puste. Wpisz jakiś kod do wykonania.", 5)
    end
end)

ClearButton.MouseButton1Click:Connect(function()
    ExecutorTextBox.Text = ""
    sendNotification("Executor", "Pole tekstowe wyczyszczone.", 2)
end)


-- Zdarzenie zakupu Game Passa
MarketplaceService.PromptGamePassPurchaseFinished:Connect(function(userId, gamePassId, wasPurchased)
    if userId == player.UserId and gamePassId == GAMEPASS_ID then
        if wasPurchased then
            sendNotification("Universal Scripts", "Wersja premium kupiona pomyślnie! Dziękujemy za zakup.")
            hasGamePass = true
            showTab("Premium")
        else
            sendNotification("Universal Scripts", "Anulowano zakup wersji premium.")
        end
    end
end)

-- Monitoruj zmiany PlaceId (np. po teleportacji)
game.Changed:Connect(function(property)
    if property == "PlaceId" then
        updateSpecialButtonVisibility()
    end
end)

--- Inicjalizacja skryptu ---
spawn(function()
    task.wait(1) -- Daj chwilę na załadowanie GUI

    checkGamePassStatus() -- Sprawdzamy Game Passa na start i wysyłamy pierwsze powiadomienie
    updateSpecialButtonVisibility() -- Aktualizujemy widoczność specjalnych przycisków na start
    showTab("Home") -- Wyświetl zakładkę Home jako domyślną
    sendNotification("Universal Scripts", "Witaj w Universal Scripts! Skrypt załadowany.")
end)

print("Universal Scripts z Executorem załadowany i gotowy do działania.")
