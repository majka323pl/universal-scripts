local player = game.Players.LocalPlayer
local UserInputService = game:GetService("UserInputService")
local MarketplaceService = game:GetService("MarketplaceService")
local StarterGui = game:GetService("StarterGui")
local RunService = game:GetService("RunService")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")

local GAMEPASS_ID = 1296972626
local MM2_EXPERIENCE_ID = 142823291 -- Murder Mystery 2 PlaceId
local GAG_GAME_ID = 9262276941     -- Guess A Game PlaceId
local TELEPORT_PLACE_ID = 6557073879

local hasGamePass = false
local initialGamePassCheckDone = false

-- RĘCZNIE WPROWADZANE LOGI AKTUALIZACJI
local MANUAL_UPDATE_LOGS = [[
--- Dziennik Zmian ---
[23.07.2025] Wersja 1.8 - Przywrócenie Skalowania Guzików
- **Przywrócono oryginalne skalowanie guzików:** Ustawiono `CellSize` i `CellPadding` w `UIGridLayout` dla sekcji Home i Premium na poprzednie wartości, zapewniając znany wygląd i rozmieszczenie przycisków.
- Zachowano wszystkie poprzednie poprawki dotyczące widoczności przycisków Premium oraz mechaniki Place ID.
- Potwierdzono poprawne działanie HideButton i ogólnej funkcjonalności GUI.

[24.07.2025] Wersja 1.7 - Krytyczna poprawka guzików Premium
- **Kompletna przebudowa i regeneracja sekcji Premium:** Wszystkie 7 przycisków (Spectate, Console, Invisibility, Fling, MM2, GhostMM2, GAG) zostały odtworzone od podstaw, aby zapewnić ich poprawne renderowanie i działanie.
- **Weryfikacja pozycjonowania:** Upewniono się, że przyciski mają prawidłowe pozycje i rozmiary w obrębie ScrollingFramePremium.
- **Wzmocniona logika widoczności:** Przetestowano i ulepszono mechanizm pokazywania/ukrywania przycisków MM2, GhostMM2 i GAG w zależności od PlaceId gry.
- Wprowadzono dodatkowe sprawdzenia i powiadomienia w konsoli w celu debugowania.

[24.07.2025] Wersja 1.6
- **Kluczowa poprawka:** Przywrócono wszystkie 7 przycisków w zakładce Premium (Spectate, Console, Invisibility, Fling, MM2, GhostMM2, GAG) zgodnie z oryginalnym skryptem.
- **Naprawiono widoczność przycisków MM2, GhostMM2 i GAG:** Teraz są poprawnie pokazywane tylko w odpowiednich grach (MM2 i GAG).
- Upewniono się, że przyciski specyficzne dla gier są ukryte w innych grach.
- Zoptymalizowano logikę przełączania zakładek i sprawdzania GamePassa.
- Zachowano funkcjonalność Executor i Update Logs.
]]

local function sendNotification(title, text)
    StarterGui:SetCore("SendNotification", {
        Title = title,
        Text = text,
        Icon = "rbxassetid://102860171689689",
        Duration = 5
    })
end

--- Funkcje do pobierania i wykonywania skryptów z URL ---
local function runScriptAndNotify(url, buttonName)
    local success, err = pcall(function()
        local scriptContent = game:HttpGet(url, true)
        if scriptContent and scriptContent:len() > 0 then
            local loadedFunction = loadstring(scriptContent)
            if loadedFunction then
                local execSuccess, execErr = pcall(loadedFunction)
                if execSuccess then
                    sendNotification("Universal Scripts", "Skrypt '" .. buttonName .. "' załadowany!")
                    print("SKRYPT ZALADOWANY: " .. buttonName) -- Debug
                else
                    sendNotification("Universal Scripts", "Błąd wykonania skryptu '" .. buttonName .. "': " .. tostring(execErr))
                    warn("Błąd wykonania skryptu '" .. buttonName .. "':", execErr)
                end
            else
                sendNotification("Universal Scripts", "Błąd wczytywania skryptu (loadstring) dla '" .. buttonName .. "': " .. tostring(err))
                warn("Błąd wczytywania skryptu (loadstring) dla '" .. buttonName .. "':", err)
            end
        else
            sendNotification("Universal Scripts", "Pobrany skrypt dla '" .. buttonName .. "' jest pusty.")
            warn("Pobrany skrypt dla '" .. buttonName .. "' jest pusty.")
        end
    end)
    if not success then
        sendNotification("Universal Scripts", "Krytyczny błąd pobierania/ładowania skryptu '" .. buttonName .. "': " .. tostring(err))
        warn("Krytyczny błąd pobierania/ładowania skryptu '" .. buttonName .. "':", err)
    end
end

-- Funkcja pomocnicza do sprawdzania statusu premium przed uruchomieniem skryptu Premium
local function checkPremiumAndRunScript(scriptUrl, buttonName)
    local successGP, currentHasGamePass = pcall(function()
        return MarketplaceService:UserOwnsGamePassAsync(player.UserId, GAMEPASS_ID)
    end)

    if (successGP and currentHasGamePass) then
        runScriptAndNotify(scriptUrl, buttonName)
    else
        sendNotification("Universal Scripts", "Musisz posiadać wersję premium, aby użyć tej funkcji!")
        MarketplaceService:PromptGamePassPurchase(player, GAMEPASS_ID)
    end
end

-- Deklaracje instancji GUI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Parent = player:WaitForChild("PlayerGui")
ScreenGui.Name = "UniversalScriptsGUI"
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ScreenGui.ResetOnSpawn = false
ScreenGui.Enabled = true

local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.new(0.172549, 0.172549, 0.172549)
MainFrame.BorderColor3 = Color3.new(0, 0, 0)
MainFrame.BorderSizePixel = 0
MainFrame.Position = UDim2.new(0.212787732, 0, 0.244107679, 0)
MainFrame.Size = UDim2.new(0.513162374, 0, 0.560262501, 0)
MainFrame.Draggable = true
MainFrame.Visible = true

local UICorner = Instance.new("UICorner")
UICorner.Parent = MainFrame

local TabsFrame = Instance.new("Frame")
TabsFrame.Name = "TabsFrame"
TabsFrame.Parent = MainFrame
TabsFrame.BackgroundColor3 = Color3.new(0.141176, 0.141176, 0.141176)
TabsFrame.BorderColor3 = Color3.new(0, 0, 0)
TabsFrame.BorderSizePixel = 0
TabsFrame.Position = UDim2.new(0, 0, 3.349695e-8, 0)
TabsFrame.Size = UDim2.new(0.21077837, 0, 0.998841524, 0)
Instance.new("UICorner", TabsFrame)
Instance.new("UIAspectRatioConstraint", TabsFrame).AspectRatio = 0.37142857909202576

local HomeTabButton = Instance.new("TextButton")
HomeTabButton.Name = "HomeTabButton"
HomeTabButton.Parent = TabsFrame
HomeTabButton.BackgroundColor3 = Color3.new(0.419608, 0.419608, 0.419608)
HomeTabButton.BorderColor3 = Color3.new(0, 0, 0)
HomeTabButton.BorderSizePixel = 0
HomeTabButton.Position = UDim2.new(0.0591715984, 0, 0.112087913, 0)
HomeTabButton.Size = UDim2.new(0.881656826, 0, 0.083516486, 0)
HomeTabButton.Font = Enum.Font.SourceSans
HomeTabButton.Text = "Home"
HomeTabButton.TextColor3 = Color3.new(0, 0, 0)
HomeTabButton.TextScaled = true
HomeTabButton.TextSize = 14
HomeTabButton.TextWrapped = true
Instance.new("UICorner", HomeTabButton)
Instance.new("UITextSizeConstraint", HomeTabButton).MaxTextSize = 37
Instance.new("UIAspectRatioConstraint", HomeTabButton).AspectRatio = 3.9210526943206787

local PremiumTabButton = Instance.new("TextButton")
PremiumTabButton.Name = "PremiumTabButton"
PremiumTabButton.Parent = TabsFrame
PremiumTabButton.BackgroundColor3 = Color3.new(0.419608, 0.419608, 0.419608)
PremiumTabButton.BorderColor3 = Color3.new(0, 0, 0)
PremiumTabButton.BorderSizePixel = 0
PremiumTabButton.Position = UDim2.new(0.0591715984, 0, 0.237362638, 0)
PremiumTabButton.Size = UDim2.new(0.881656826, 0, 0.083516486, 0)
PremiumTabButton.Font = Enum.Font.SourceSans
PremiumTabButton.Text = "Premium"
PremiumTabButton.TextColor3 = Color3.new(0, 0, 0)
PremiumTabButton.TextScaled = true
PremiumTabButton.TextSize = 14
PremiumTabButton.TextWrapped = true
Instance.new("UICorner", PremiumTabButton)
Instance.new("UITextSizeConstraint", PremiumTabButton).MaxTextSize = 37
Instance.new("UIAspectRatioConstraint", PremiumTabButton).AspectRatio = 3.9210526943206787

local ExecutorTabButton = Instance.new("TextButton")
ExecutorTabButton.Name = "ExecutorTabButton"
ExecutorTabButton.Parent = TabsFrame
ExecutorTabButton.BackgroundColor3 = Color3.new(0.419608, 0.419608, 0.419608)
ExecutorTabButton.BorderColor3 = Color3.new(0, 0, 0)
ExecutorTabButton.BorderSizePixel = 0
ExecutorTabButton.Position = UDim2.new(0.0591715984, 0, 0.36263737, 0)
ExecutorTabButton.Size = UDim2.new(0.881656826, 0, 0.083516486, 0)
ExecutorTabButton.Font = Enum.Font.SourceSans
ExecutorTabButton.Text = "Executor"
ExecutorTabButton.TextColor3 = Color3.new(0, 0, 0)
ExecutorTabButton.TextScaled = true
ExecutorTabButton.TextSize = 14
ExecutorTabButton.TextWrapped = true
Instance.new("UICorner", ExecutorTabButton)
Instance.new("UITextSizeConstraint", ExecutorTabButton).MaxTextSize = 37
Instance.new("UIAspectRatioConstraint", ExecutorTabButton).AspectRatio = 3.9473683834075928

local UpdateLogsTabButton = Instance.new("TextButton")
UpdateLogsTabButton.Name = "UpdateLogsTabButton"
UpdateLogsTabButton.Parent = TabsFrame
UpdateLogsTabButton.BackgroundColor3 = Color3.new(0.419608, 0.419608, 0.419608)
UpdateLogsTabButton.BorderColor3 = Color3.new(0, 0, 0)
UpdateLogsTabButton.BorderSizePixel = 0
UpdateLogsTabButton.Position = UDim2.new(0.0591715984, 0, 0.487912089, 0)
UpdateLogsTabButton.Size = UDim2.new(0.881656826, 0, 0.083516486, 0)
UpdateLogsTabButton.Font = Enum.Font.SourceSans
UpdateLogsTabButton.Text = "Update Logs"
UpdateLogsTabButton.TextColor3 = Color3.new(0, 0, 0)
UpdateLogsTabButton.TextScaled = true
UpdateLogsTabButton.TextSize = 14
UpdateLogsTabButton.TextWrapped = true
Instance.new("UICorner", UpdateLogsTabButton)
Instance.new("UITextSizeConstraint", UpdateLogsTabButton).MaxTextSize = 37
Instance.new("UIAspectRatioConstraint", UpdateLogsTabButton).AspectRatio = 3.9473683834075928

-- --- NOWA REKONSTRUKCJA ScrollingFramePremium i JEGO PRZYCISKÓW ---
local ScrollingFramePremium = Instance.new("ScrollingFrame")
ScrollingFramePremium.Name = "ScrollingFramePremium"
ScrollingFramePremium.Parent = MainFrame
ScrollingFramePremium.Active = true
ScrollingFramePremium.BackgroundColor3 = Color3.new(0.231373, 0.231373, 0.231373)
ScrollingFramePremium.BorderColor3 = Color3.new(0, 0, 0)
ScrollingFramePremium.BorderSizePixel = 0
ScrollingFramePremium.Position = UDim2.new(0.239610985, 0, 0.1111193, 0)
ScrollingFramePremium.Size = UDim2.new(0.733235598, 0, 0.864629686, 0)
ScrollingFramePremium.CanvasSize = UDim2.new(0,0,1.5,0) -- Dostosowane dynamicznie
ScrollingFramePremium.Visible = false
Instance.new("UICorner", ScrollingFramePremium)
Instance.new("UIAspectRatioConstraint", ScrollingFramePremium).AspectRatio = 1.4926543235778809

-- Layout dla przycisków Premium, aby automatycznie je układać
local UIGridLayoutPremium = Instance.new("UIGridLayout")
UIGridLayoutPremium.Parent = ScrollingFramePremium
UIGridLayoutPremium.FillDirection = Enum.FillDirection.Horizontal
UIGridLayoutPremium.StartCorner = Enum.StartCorner.TopLeft
UIGridLayoutPremium.HorizontalAlignment = Enum.HorizontalAlignment.Center
UIGridLayoutPremium.VerticalAlignment = Enum.VerticalAlignment.Top
**UIGridLayoutPremium.CellSize = UDim2.new(0.45, 0, 0.08, 0)** -- Przywrócone stare skalowanie
**UIGridLayoutPremium.CellPadding = UDim2.new(0.02, 0, 0.02, 0)** -- Przywrócone stare skalowanie

-- Przycisk: Spectate
local SpectateButton_Premium = Instance.new("TextButton")
SpectateButton_Premium.Name = "Spectate Button Premium"
SpectateButton_Premium.Parent = ScrollingFramePremium
SpectateButton_Premium.BackgroundColor3 = Color3.new(0.356863, 0.356863, 0.356863)
SpectateButton_Premium.BorderColor3 = Color3.new(0, 0, 0)
SpectateButton_Premium.Font = Enum.Font.SourceSans
SpectateButton_Premium.Text = "Spectate"
SpectateButton_Premium.TextColor3 = Color3.new(0, 0, 0)
SpectateButton_Premium.TextScaled = true
SpectateButton_Premium.TextSize = 14
SpectateButton_Premium.TextWrapped = true
Instance.new("UICorner", SpectateButton_Premium)
Instance.new("UITextSizeConstraint", SpectateButton_Premium).MaxTextSize = 37

-- Przycisk: Console
local ConsoleButton_Premium = Instance.new("TextButton")
ConsoleButton_Premium.Name = "Console Button"
ConsoleButton_Premium.Parent = ScrollingFramePremium
ConsoleButton_Premium.BackgroundColor3 = Color3.new(0.356863, 0.356863, 0.356863)
ConsoleButton_Premium.BorderColor3 = Color3.new(0, 0, 0)
ConsoleButton_Premium.Font = Enum.Font.SourceSans
ConsoleButton_Premium.Text = "Console"
ConsoleButton_Premium.TextColor3 = Color3.new(0, 0, 0)
ConsoleButton_Premium.TextScaled = true
ConsoleButton_Premium.TextSize = 14
ConsoleButton_Premium.TextWrapped = true
Instance.new("UICorner", ConsoleButton_Premium)
Instance.new("UITextSizeConstraint", ConsoleButton_Premium).MaxTextSize = 37

-- Przycisk: Invisibility
local Invisibiltybutton = Instance.new("TextButton")
Invisibiltybutton.Name = "Invisibilty Button"
Invisibiltybutton.Parent = ScrollingFramePremium
Invisibiltybutton.BackgroundColor3 = Color3.new(0.356863, 0.356863, 0.356863)
Invisibiltybutton.BorderColor3 = Color3.new(0, 0, 0)
Invisibiltybutton.Font = Enum.Font.SourceSans
Invisibiltybutton.Text = "Invisibilty"
Invisibiltybutton.TextColor3 = Color3.new(0, 0, 0)
Invisibiltybutton.TextScaled = true
Invisibiltybutton.TextSize = 14
Invisibiltybutton.TextWrapped = true
Instance.new("UICorner", Invisibiltybutton)
Instance.new("UITextSizeConstraint", Invisibiltybutton).MaxTextSize = 37

-- Przycisk: Fling
local FlingButton_Premium = Instance.new("TextButton")
FlingButton_Premium.Name = "Fling Button Premium"
FlingButton_Premium.Parent = ScrollingFramePremium
FlingButton_Premium.BackgroundColor3 = Color3.new(0.356863, 0.356863, 0.356863)
FlingButton_Premium.BorderColor3 = Color3.new(0, 0, 0)
FlingButton_Premium.Font = Enum.Font.SourceSans
FlingButton_Premium.Text = "Fling"
FlingButton_Premium.TextColor3 = Color3.new(0, 0, 0)
FlingButton_Premium.TextScaled = true
FlingButton_Premium.TextSize = 14
FlingButton_Premium.TextWrapped = true
Instance.new("UICorner", FlingButton_Premium)
Instance.new("UITextSizeConstraint", FlingButton_Premium).MaxTextSize = 37

-- Przycisk: MM2 (Specyficzny dla gry)
local MM2Button = Instance.new("TextButton")
MM2Button.Name = "MM2 Button"
MM2Button.Parent = ScrollingFramePremium
MM2Button.BackgroundColor3 = Color3.new(0.356863, 0.356863, 0.356863)
MM2Button.BorderColor3 = Color3.new(0, 0, 0)
MM2Button.Font = Enum.Font.SourceSans
MM2Button.Text = "MM2"
MM2Button.TextColor3 = Color3.new(0, 0, 0)
MM2Button.TextScaled = true
MM2Button.TextSize = 14
MM2Button.TextWrapped = true
MM2Button.Visible = false -- Domyślnie ukryte, widoczność zarządzana przez updateGameSpecificButtons
Instance.new("UICorner", MM2Button)
Instance.new("UITextSizeConstraint", MM2Button).MaxTextSize = 37

-- Przycisk: GhostMM2 (Specyficzny dla gry)
local GhostMM2Button = Instance.new("TextButton")
GhostMM2Button.Name = "GhostMM2 Button"
GhostMM2Button.Parent = ScrollingFramePremium
GhostMM2Button.BackgroundColor3 = Color3.new(0.356863, 0.356863, 0.356863)
GhostMM2Button.BorderColor3 = Color3.new(0, 0, 0)
GhostMM2Button.Font = Enum.Font.SourceSans
GhostMM2Button.Text = "GhostMM2"
GhostMM2Button.TextColor3 = Color3.new(0, 0, 0)
GhostMM2Button.TextScaled = true
GhostMM2Button.TextSize = 14
GhostMM2Button.TextWrapped = true
GhostMM2Button.Visible = false -- Domyślnie ukryte, widoczność zarządzana przez updateGameSpecificButtons
Instance.new("UICorner", GhostMM2Button)
Instance.new("UITextSizeConstraint", GhostMM2Button).MaxTextSize = 37

-- Przycisk: GAG (Specyficzny dla gry)
local GAGButton = Instance.new("TextButton")
GAGButton.Name = "GAG Button"
GAGButton.Parent = ScrollingFramePremium
GAGButton.BackgroundColor3 = Color3.new(0.356863, 0.356863, 0.356863)
GAGButton.BorderColor3 = Color3.new(0, 0, 0)
GAGButton.Font = Enum.Font.SourceSans
GAGButton.Text = "GAG"
GAGButton.TextColor3 = Color3.new(0, 0, 0)
GAGButton.TextScaled = true
GAGButton.TextSize = 14
GAGButton.TextWrapped = true
GAGButton.Visible = false -- Domyślnie ukryte, widoczność zarządzana przez updateGameSpecificButtons
Instance.new("UICorner", GAGButton)
Instance.new("UITextSizeConstraint", GAGButton).MaxTextSize = 37
-- --- KONIEC NOWEJ REKONSTRUKCJI ---

local TitleLabel = Instance.new("TextLabel")
TitleLabel.Name = "TitleLabel"
TitleLabel.Parent = MainFrame
TitleLabel.BackgroundColor3 = Color3.new(1, 1, 1)
TitleLabel.BackgroundTransparency = 1
TitleLabel.BorderColor3 = Color3.new(0, 0, 0)
TitleLabel.BorderSizePixel = 0
TitleLabel.Position = UDim2.new(0.425298363, 0, 0.0153667927, 0)
TitleLabel.Size = UDim2.new(0.3616907, 0, 0.0724434555, 0)
TitleLabel.Font = Enum.Font.LuckiestGuy
TitleLabel.Text = "UNIVERSAL SCRIPTS"
TitleLabel.TextColor3 = Color3.new(1, 1, 1)
TitleLabel.TextScaled = true
TitleLabel.TextSize = 14
TitleLabel.TextWrapped = true
Instance.new("UITextSizeConstraint", TitleLabel).MaxTextSize = 31
Instance.new("UIAspectRatioConstraint", TitleLabel).AspectRatio = 8.78787899017334

local ScrollingFrameHome = Instance.new("ScrollingFrame")
ScrollingFrameHome.Name = "ScrollingFrameHome"
ScrollingFrameHome.Parent = MainFrame
ScrollingFrameHome.Active = true
ScrollingFrameHome.BackgroundColor3 = Color3.new(0.231373, 0.231373, 0.231373)
ScrollingFrameHome.BorderColor3 = Color3.new(0, 0, 0)
ScrollingFrameHome.BorderSizePixel = 0
ScrollingFrameHome.Position = UDim2.new(0.239610985, 0, 0.113314532, 0)
ScrollingFrameHome.Size = UDim2.new(0.733235598, 0, 0.864629686, 0)
ScrollingFrameHome.CanvasSize = UDim2.new(0,0,1.5,0)
Instance.new("UICorner", ScrollingFrameHome)
Instance.new("UIAspectRatioConstraint", ScrollingFrameHome).AspectRatio = 1.4926543235778809

-- Layout dla przycisków Home
local UIGridLayoutHome = Instance.new("UIGridLayout")
UIGridLayoutHome.Parent = ScrollingFrameHome
UIGridLayoutHome.FillDirection = Enum.FillDirection.Horizontal
UIGridLayoutHome.StartCorner = Enum.StartCorner.TopLeft
UIGridLayoutHome.HorizontalAlignment = Enum.HorizontalAlignment.Center
UIGridLayoutHome.VerticalAlignment = Enum.VerticalAlignment.Top
**UIGridLayoutHome.CellSize = UDim2.new(0.45, 0, 0.08, 0)** -- Przywrócone stare skalowanie
**UIGridLayoutHome.CellPadding = UDim2.new(0.02, 0, 0.02, 0)** -- Przywrócone stare skalowanie

local SpeedToolbutton = Instance.new("TextButton")
SpeedToolbutton.Name = "Speed Tool button"
SpeedToolbutton.Parent = ScrollingFrameHome
SpeedToolbutton.BackgroundColor3 = Color3.new(0.356863, 0.356863, 0.356863)
SpeedToolbutton.BorderColor3 = Color3.new(0, 0, 0)
SpeedToolbutton.Font = Enum.Font.SourceSans
SpeedToolbutton.Text = "Speed Tool"
SpeedToolbutton.TextColor3 = Color3.new(0, 0, 0)
SpeedToolbutton.TextScaled = true
SpeedToolbutton.TextSize = 14
SpeedToolbutton.TextWrapped = true
Instance.new("UICorner", SpeedToolbutton)
Instance.new("UITextSizeConstraint", SpeedToolbutton).MaxTextSize = 37

local ClicktptoolButton = Instance.new("TextButton")
ClicktptoolButton.Name = "Click tp tool Button"
ClicktptoolButton.Parent = ScrollingFrameHome
ClicktptoolButton.BackgroundColor3 = Color3.new(0.356863, 0.356863, 0.356863)
ClicktptoolButton.BorderColor3 = Color3.new(0, 0, 0)
ClicktptoolButton.Font = Enum.Font.SourceSans
ClicktptoolButton.Text = "Click tp tool"
ClicktptoolButton.TextColor3 = Color3.new(0, 0, 0)
ClicktptoolButton.TextScaled = true
ClicktptoolButton.TextSize = 14
ClicktptoolButton.TextWrapped = true
Instance.new("UICorner", ClicktptoolButton)
Instance.new("UITextSizeConstraint", ClicktptoolButton).MaxTextSize = 35

local NoclipButton = Instance.new("TextButton")
NoclipButton.Name = "Noclip Button"
NoclipButton.Parent = ScrollingFrameHome
NoclipButton.BackgroundColor3 = Color3.new(0.356863, 0.356863, 0.356863)
NoclipButton.BorderColor3 = Color3.new(0, 0, 0)
NoclipButton.Font = Enum.Font.SourceSans
NoclipButton.Text = "Noclip"
NoclipButton.TextColor3 = Color3.new(0, 0, 0)
NoclipButton.TextScaled = true
NoclipButton.TextSize = 14
NoclipButton.TextWrapped = true
Instance.new("UICorner", NoclipButton)
Instance.new("UITextSizeConstraint", NoclipButton).MaxTextSize = 37

local InfinityJumpButton = Instance.new("TextButton")
InfinityJumpButton.Name = "Infinity Jump Button"
InfinityJumpButton.Parent = ScrollingFrameHome
InfinityJumpButton.BackgroundColor3 = Color3.new(0.356863, 0.356863, 0.356863)
InfinityJumpButton.BorderColor3 = Color3.new(0, 0, 0)
InfinityJumpButton.Font = Enum.Font.SourceSans
InfinityJumpButton.Text = "Infinity Jump"
InfinityJumpButton.TextColor3 = Color3.new(0, 0, 0)
InfinityJumpButton.TextScaled = true
InfinityJumpButton.TextSize = 14
InfinityJumpButton.TextWrapped = true
Instance.new("UICorner", InfinityJumpButton)
Instance.new("UITextSizeConstraint", InfinityJumpButton).MaxTextSize = 37

local AntiFlingButton = Instance.new("TextButton")
AntiFlingButton.Name = "Anti-Fling Button"
AntiFlingButton.Parent = ScrollingFrameHome
AntiFlingButton.BackgroundColor3 = Color3.new(0.356863, 0.356863, 0.356863)
AntiFlingButton.BorderColor3 = Color3.new(0, 0, 0)
AntiFlingButton.Font = Enum.Font.SourceSans
AntiFlingButton.Text = "Anti-Fling"
AntiFlingButton.TextColor3 = Color3.new(0, 0, 0)
AntiFlingButton.TextScaled = true
AntiFlingButton.TextSize = 14
AntiFlingButton.TextWrapped = true
Instance.new("UICorner", AntiFlingButton)
Instance.new("UITextSizeConstraint", AntiFlingButton).MaxTextSize = 37

local FlyButtonHome = Instance.new("TextButton")
FlyButtonHome.Name = "Fly Button Home"
FlyButtonHome.Parent = ScrollingFrameHome
FlyButtonHome.BackgroundColor3 = Color3.new(0.356863, 0.356863, 0.356863)
FlyButtonHome.BorderColor3 = Color3.new(0, 0, 0)
FlyButtonHome.Font = Enum.Font.SourceSans
FlyButtonHome.Text = "Fly"
FlyButtonHome.TextColor3 = Color3.new(0, 0, 0)
FlyButtonHome.TextScaled = true
FlyButtonHome.TextSize = 14
FlyButtonHome.TextWrapped = true
Instance.new("UICorner", FlyButtonHome)
Instance.new("UITextSizeConstraint", FlyButtonHome).MaxTextSize = 37

--- NOWE ELEMENTY GUI DLA ZAKŁADKI EXECUTOR ---
local ExecutorFrame = Instance.new("Frame")
ExecutorFrame.Name = "ExecutorFrame"
ExecutorFrame.Parent = MainFrame
ExecutorFrame.BackgroundColor3 = Color3.new(0.231373, 0.231373, 0.231373)
ExecutorFrame.BorderColor3 = Color3.new(0, 0, 0)
ExecutorFrame.BorderSizePixel = 0
ExecutorFrame.Position = UDim2.new(0.239610985, 0, 0.113314532, 0)
ExecutorFrame.Size = UDim2.new(0.733235598, 0, 0.864629686, 0)
ExecutorFrame.Visible = false
Instance.new("UICorner", ExecutorFrame)

local ExecutorLayout = Instance.new("UIListLayout")
ExecutorLayout.Parent = ExecutorFrame
ExecutorLayout.FillDirection = Enum.FillDirection.Vertical
ExecutorLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
ExecutorLayout.Padding = UDim.new(0, 10)

local ExecutorTextBox = Instance.new("TextBox")
ExecutorTextBox.Name = "ExecutorTextBox"
ExecutorTextBox.Parent = ExecutorFrame
ExecutorTextBox.Size = UDim2.new(0.95, 0, 0.75, 0)
ExecutorTextBox.BackgroundColor3 = Color3.new(0.12, 0.12, 0.12)
ExecutorTextBox.BorderColor3 = Color3.new(0, 0, 0)
ExecutorTextBox.BorderSizePixel = 1
ExecutorTextBox.Font = Enum.Font.SourceSans
ExecutorTextBox.Text = "-- Wklej tutaj swój kod Lua"
ExecutorTextBox.TextColor3 = Color3.new(1, 1, 1)
ExecutorTextBox.TextSize = 18
ExecutorTextBox.TextWrapped = true
ExecutorTextBox.MultiLine = true
ExecutorTextBox.ClearTextOnFocus = true
ExecutorTextBox.PlaceholderText = "-- Wklej tutaj swój kod Lua"
Instance.new("UICorner", ExecutorTextBox)

local ExecutorButtonsFrame = Instance.new("Frame")
ExecutorButtonsFrame.Name = "ExecutorButtonsFrame"
ExecutorButtonsFrame.Parent = ExecutorFrame
ExecutorButtonsFrame.Size = UDim2.new(0.95, 0, 0.15, 0)
ExecutorButtonsFrame.BackgroundTransparency = 1
Instance.new("UIListLayout", ExecutorButtonsFrame).FillDirection = Enum.FillDirection.Horizontal
Instance.new("UIListLayout", ExecutorButtonsFrame).HorizontalAlignment = Enum.HorizontalAlignment.Center
Instance.new("UIListLayout", ExecutorButtonsFrame).Padding = UDim.new(0, 10)

local ExecuteButton = Instance.new("TextButton")
ExecuteButton.Name = "ExecuteButton"
ExecuteButton.Parent = ExecutorButtonsFrame
ExecuteButton.Size = UDim2.new(0.48, 0, 1, 0)
ExecuteButton.BackgroundColor3 = Color3.new(0.356863, 0.356863, 0.356863)
ExecuteButton.BorderColor3 = Color3.new(0, 0, 0)
ExecuteButton.Text = "Execute"
ExecuteButton.Font = Enum.Font.SourceSans
ExecuteButton.TextColor3 = Color3.new(0, 0, 0)
ExecuteButton.TextScaled = true
Instance.new("UICorner", ExecuteButton)

local ClearButton = Instance.new("TextButton")
ClearButton.Name = "ClearButton"
ClearButton.Parent = ExecutorButtonsFrame
ClearButton.Size = UDim2.new(0.48, 0, 1, 0)
ClearButton.BackgroundColor3 = Color3.new(0.356863, 0.356863, 0.356863)
ClearButton.BorderColor3 = Color3.new(0, 0, 0)
ClearButton.Text = "Clear"
ClearButton.Font = Enum.Font.SourceSans
ClearButton.TextColor3 = Color3.new(0, 0, 0)
ClearButton.TextScaled = true
Instance.new("UICorner", ClearButton)

--- ELEMENTY GUI DLA ZAKŁADKI UPDATE LOGS (RĘCZNE LOGI) ---
local UpdateLogsFrame = Instance.new("ScrollingFrame")
UpdateLogsFrame.Name = "UpdateLogsFrame"
UpdateLogsFrame.Parent = MainFrame
UpdateLogsFrame.Active = true
UpdateLogsFrame.BackgroundColor3 = Color3.new(0.231373, 0.231373, 0.231373)
UpdateLogsFrame.BorderColor3 = Color3.new(0, 0, 0)
UpdateLogsFrame.BorderSizePixel = 0
UpdateLogsFrame.Position = UDim2.new(0.239610985, 0, 0.113314532, 0)
UpdateLogsFrame.Size = UDim2.new(0.733235598, 0, 0.864629686, 0)
UpdateLogsFrame.Visible = false
UpdateLogsFrame.CanvasSize = UDim2.new(0,0,1.5,0)
Instance.new("UICorner", UpdateLogsFrame)

local UpdateLogsText = Instance.new("TextLabel")
UpdateLogsText.Name = "UpdateLogsText"
UpdateLogsText.Parent = UpdateLogsFrame
UpdateLogsText.BackgroundColor3 = Color3.new(1, 1, 1)
UpdateLogsText.BackgroundTransparency = 1
UpdateLogsText.Position = UDim2.new(0.05, 0, 0.02, 0)
UpdateLogsText.Size = UDim2.new(0.9, 0, 0.96, 0)
UpdateLogsText.Font = Enum.Font.SourceSans
UpdateLogsText.TextXAlignment = Enum.TextXAlignment.Left
UpdateLogsText.TextYAlignment = Enum.TextYAlignment.Top
UpdateLogsText.Text = MANUAL_UPDATE_LOGS
UpdateLogsText.TextColor3 = Color3.new(1, 1, 1)
UpdateLogsText.TextScaled = false
UpdateLogsText.TextSize = 16
UpdateLogsText.TextWrapped = true

Instance.new("UIAspectRatioConstraint", MainFrame).AspectRatio = 1.7601344585418701
Instance.new("UIAspectRatioConstraint", ScreenGui).AspectRatio = 1.9216867685317993

-- Przycisk HideButton jest już OK, więc pomijam modyfikacje jego kodu tu.
local HideButton = Instance.new("ImageButton")
HideButton.Name = "HideButton"
HideButton.Parent = ScreenGui
HideButton.BackgroundColor3 = Color3.new(1, 0, 0)
HideButton.BorderColor3 = Color3.new(0, 0, 0)
HideButton.BorderSizePixel = 3
HideButton.Image = "rbxassetid://102860171689689"
HideButton.ImageColor3 = Color3.new(1, 1, 1)
HideButton.ScaleType = Enum.ScaleType.Fit
HideButton.Position = UDim2.new(0.707863092, 0, 0.214006022, 0)
HideButton.Size = UDim2.new(0, 30, 0, 30)
HideButton.ZIndex = 5
HideButton.Draggable = true

--- Funkcje i logika skryptu ---

local function updateGameSpecificButtons()
    local currentPlaceId = game.PlaceId
    print("Aktualny PlaceId: " .. currentPlaceId) -- Debug

    -- Ustaw wszystkie 7 przycisków Premium na widoczne domyślnie
    SpectateButton_Premium.Visible = true
    ConsoleButton_Premium.Visible = true
    Invisibiltybutton.Visible = true
    FlingButton_Premium.Visible = true
    MM2Button.Visible = true -- Ustawiamy na true, by potem warunkowo ukryć
    GhostMM2Button.Visible = true -- Ustawiamy na true, by potem warunkowo ukryć
    GAGButton.Visible = true -- Ustawiamy na true, by potem warunkowo ukryć

    -- Logika ukrywania/pokazywania przycisków specyficznych dla gry
    if currentPlaceId == MM2_EXPERIENCE_ID then
        print("Wykryto MM2. Przyciski MM2 i GhostMM2 widoczne.") -- Debug
        -- MM2Button i GhostMM2Button już są widoczne
        GAGButton.Visible = false -- Ukryj GAG w MM2
    elseif currentPlaceId == GAG_GAME_ID then
        print("Wykryto GAG. Przycisk GAG widoczny.") -- Debug
        -- GAGButton już jest widoczny
        MM2Button.Visible = false -- Ukryj MM2 w GAG
        GhostMM2Button.Visible = false -- Ukryj GhostMM2 w GAG
    else
        print("Brak wykrytej gry MM2/GAG. Przyciski specyficzne dla gier ukryte.") -- Debug
        MM2Button.Visible = false
        GhostMM2Button.Visible = false
        GAGButton.Visible = false
    end

    -- Odświeżenie CanvasSize ScrollingFramePremium, aby layout działał prawidłowo
    task.wait(0.1) -- Krótka pauza, aby layout mógł obliczyć swoje rozmiary
    if ScrollingFramePremium.Visible then
        local contentHeight = UIGridLayoutPremium.AbsoluteContentSize.Y
        local frameHeight = ScrollingFramePremium.AbsoluteSize.Y
        ScrollingFramePremium.CanvasSize = UDim2.new(0, 0, 0, math.max(contentHeight + UIGridLayoutPremium.CellPadding.Y.Offset * 2, frameHeight)) -- Dodano padding dla pewności
        print("Zaktualizowano CanvasSize Premium: " .. ScrollingFramePremium.CanvasSize.Y.Offset) -- Debug
    end
end

local function showTab(tabName)
    print("Zmiana zakładki na: " .. tabName) -- Debug

    -- Ukryj wszystkie ramki treści
    ScrollingFrameHome.Visible = false
    ScrollingFramePremium.Visible = false
    ExecutorFrame.Visible = false
    UpdateLogsFrame.Visible = false

    -- Zresetuj kolory wszystkich przycisków zakładek
    HomeTabButton.BackgroundColor3 = Color3.new(0.419608, 0.419608, 0.419608)
    PremiumTabButton.BackgroundColor3 = Color3.new(0.419608, 0.419608, 0.419608)
    ExecutorTabButton.BackgroundColor3 = Color3.new(0.419608, 0.419608, 0.419608)
    UpdateLogsTabButton.BackgroundColor3 = Color3.new(0.419608, 0.419608, 0.419608)

    if tabName == "Home" then
        ScrollingFrameHome.Visible = true
        HomeTabButton.BackgroundColor3 = Color3.new(0.5, 0.5, 0.5)
    elseif tabName == "Premium" then
        local success, result = pcall(function()
            return MarketplaceService:UserOwnsGamePassAsync(player.UserId, GAMEPASS_ID)
        end)

        if success then
            hasGamePass = result
            if hasGamePass then
                ScrollingFramePremium.Visible = true
                PremiumTabButton.BackgroundColor3 = Color3.new(0.5, 0.5, 0.5)
                updateGameSpecificButtons() -- WAŻNE: Aktualizuj widoczność po upewnieniu się, że Premium jest aktywne
                print("Zakladka Premium widoczna. GamePass OK.") -- Debug
            else
                sendNotification("Universal Scripts", "Nie posiadasz wersji premium. Teleportuję...")
                local teleportSuccess, teleportErr = pcall(function()
                    TeleportService:Teleport(TELEPORT_PLACE_ID, player)
                end)
                if not teleportSuccess then
                    warn("Błąd teleportacji przy braku GamePassa:", teleportErr)
                    sendNotification("Universal Scripts", "Błąd teleportacji: " .. tostring(teleportErr))
                end
                showTab("Home") -- Wróć do Home, jeśli nie ma premium
                print("Brak GamePassa, wracam do Home.") -- Debug
            end
        else
            warn("Błąd podczas sprawdzania wersji premium (showTab):", result)
            sendNotification("Universal Scripts", "Nie można sprawdzić statusu wersji premium. Spróbuj ponownie.")
            showTab("Home")
            print("Blad sprawdzania GamePassa, wracam do Home.") -- Debug
        end
    elseif tabName == "Executor" then
        ExecutorFrame.Visible = true
        ExecutorTabButton.BackgroundColor3 = Color3.new(0.5, 0.5, 0.5)
    elseif tabName == "UpdateLogs" then
        UpdateLogsFrame.Visible = true
        UpdateLogsTabButton.BackgroundColor3 = Color3.new(0.5, 0.5, 0.5)
    end
end

local function checkGamePassStatus()
    local success, result = pcall(function()
        return MarketplaceService:UserOwnsGamePassAsync(player.UserId, GAMEPASS_ID)
    end)

    if success then
        hasGamePass = result
        if not initialGamePassCheckDone then
            if hasGamePass then
                sendNotification("Universal Scripts", "Posiadasz wersję premium! Funkcje Premium odblokowane.")
                print("GamePass wykryty: TAK") -- Debug
                updateGameSpecificButtons() -- Sprawdź widoczność przycisków od razu po wykryciu GamePassa
            else
                sendNotification("Universal Scripts", "Nie posiadasz wersji premium. Kliknij zakładkę Premium, aby przejść do zakupu.")
                print("GamePass wykryty: NIE") -- Debug
            end
            initialGamePassCheckDone = true
        end
    else
        warn("Błąd podczas sprawdzania wersji premium:", result)
        sendNotification("Universal Scripts", "Nie można sprawdzić statusu wersji premium. Spróbuj ponownie.")
    end
end

local function updateHideButtonPosition()
    if MainFrame.Visible then
        local frameAbsolutePosition = MainFrame.AbsolutePosition
        local frameAbsoluteSize = MainFrame.AbsoluteSize
        local xButtonSize = HideButton.AbsoluteSize

        local xOffsetFromFrameRight = 5
        local yOffsetFromFrameTop = 5

        local newX = frameAbsolutePosition.X + frameAbsoluteSize.X - xButtonSize.X - xOffsetFromFrameRight
        local newY = frameAbsolutePosition.Y + yOffsetFromFrameTop
        HideButton.Position = UDim2.new(0, newX, 0, newY)
    else
        -- HideButton.Position pozostanie w ostatnim miejscu przeciągnięcia, jeśli MainFrame jest ukryty.
    end
end

-- Obsługa przycisków zakładek
HomeTabButton.MouseButton1Click:Connect(function()
    showTab("Home")
end)

PremiumTabButton.MouseButton1Click:Connect(function()
    showTab("Premium")
end)

ExecutorTabButton.MouseButton1Click:Connect(function()
    showTab("Executor")
end)

UpdateLogsTabButton.MouseButton1Click:Connect(function()
    showTab("UpdateLogs")
end)

-- Executor Buttons
ExecuteButton.MouseButton1Click:Connect(function()
    local scriptToExecute = ExecutorTextBox.Text
    if scriptToExecute and scriptToExecute:len() > 0 then
        local success, err = pcall(function()
            if typeof(loadstring) == "function" then
                local func = loadstring(scriptToExecute)
                if func then
                    local execSuccess, execErr = pcall(func)
                    if execSuccess then
                        sendNotification("Universal Scripts", "Kod wykonany pomyślnie.")
                        print("Kod z executora wykonany pomyślnie.") -- Debug
                    else
                        sendNotification("Universal Scripts", "Błąd wykonania kodu z executora: " .. tostring(execErr))
                        warn("Błąd wykonania kodu z executora:", execErr)
                    end
                else
                    sendNotification("Universal Scripts", "Błąd: Niepoprawna składnia Lua w executorze.")
                    warn("Błąd loadstring: Niepoprawna składnia Lua.")
                end
            else
                sendNotification("Universal Scripts", "Błąd: Funkcja loadstring jest niedostępna w tym środowisku.")
                warn("Funkcja loadstring jest niedostępna.")
            end
        end)
        if not success then
            sendNotification("Universal Scripts", "Krytyczny błąd podczas próby wykonania kodu: " .. tostring(err))
            warn("Krytyczny błąd pcall ExecuteButton:", err)
        end
    else
        sendNotification("Universal Scripts", "Błąd: Brak kodu do wykonania w executorze.")
    end
end)

ClearButton.MouseButton1Click:Connect(function()
    ExecutorTextBox.Text = ""
    sendNotification("Universal Scripts", "Tekst w Executorze został wyczyszczony.")
end)

--- PRZYCISKI ŁADUJĄCE ZEWNĘTRZNE SKRYPTY Z LOADSTRING ---

-- Home Tab Buttons
SpeedToolbutton.MouseButton1Click:Connect(function()
    runScriptAndNotify("https://pastebin.com/raw/X7B0HPc2", SpeedToolbutton.Text)
end)

ClicktptoolButton.MouseButton1Click:Connect(function()
    runScriptAndNotify("https://pastebin.com/raw/4KF2WJ9u", ClicktptoolButton.Text)
end)

NoclipButton.MouseButton1Click:Connect(function()
    runScriptAndNotify("https://pastebin.com/raw/CnbYfaj1", NoclipButton.Text)
end)

InfinityJumpButton.MouseButton1Click:Connect(function()
    runScriptAndNotify("https://raw.githubusercontent.com/majka323pl/universal-scripts/refs/heads/main/infinity-jump", InfinityJumpButton.Text)
end)

AntiFlingButton.MouseButton1Click:Connect(function()
    runScriptAndNotify("https://raw.githubusercontent.com/majka323pl/universal-scripts/refs/heads/main/anty-fling", AntiFlingButton.Text)
end)

FlyButtonHome.MouseButton1Click:Connect(function()
    runScriptAndNotify("https://pastebin.com/raw/xuSMWfDu", FlyButtonHome.Text)
end)

-- Premium Tab Buttons
SpectateButton_Premium.MouseButton1Click:Connect(function()
    checkPremiumAndRunScript("https://pastebin.com/raw/UFVLWQRw", SpectateButton_Premium.Text)
end)

ConsoleButton_Premium.MouseButton1Click:Connect(function()
    checkPremiumAndRunScript("https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source", ConsoleButton_Premium.Text)
end)

Invisibiltybutton.MouseButton1Click:Connect(function()
    checkPremiumAndRunScript('https://pastebin.com/raw/3Rnd9rHf', Invisibiltybutton.Text)
end)

FlingButton_Premium.MouseButton1Click:Connect(function()
    checkPremiumAndRunScript('https://raw.githubusercontent.com/0Ben1/fe/main/obf_rf6iQURzu1fqrytcnLBAvW34C9N55kS9g9G3CKz086rC47M6632sEd4ZZYB0AYgV.lua.txt', FlingButton_Premium.Text)
end)

MM2Button.MouseButton1Click:Connect(function()
    checkPremiumAndRunScript("https://raw.githubusercontent.com/vertex-peak/vertex/refs/heads/main/loadstring", MM2Button.Text)
end)

GhostMM2Button.MouseButton1Click:Connect(function()
    checkPremiumAndRunScript("https://raw.githubusercontent.com/GhostPlayer352/Test4/main/Murder%20Mystery", GhostMM2Button.Text)
end)

GAGButton.MouseButton1Click:Connect(function()
    checkPremiumAndRunScript("https://raw.githubusercontent.com/ThundarZ/Welcome/main/Main/GaG/Main.lua", GAGButton.Text)
end)

-- Obsługa zmiany widoczności MainFrame i MarketplaceService.PromptGamePassPurchaseFinished
MainFrame.VisibleChanged:Connect(function()
    updateHideButtonPosition() -- Zaktualizuj pozycję przycisku po zmianie widoczności MainFrame
end)

MarketplaceService.PromptGamePassPurchaseFinished:Connect(function(userId, gamePassId, wasPurchased)
    if userId == player.UserId and gamePassId == GAMEPASS_ID then
        if wasPurchased then
            sendNotification("Universal Scripts", "Wersja premium kupiona pomyślnie! Dziękujemy za zakup.")
            hasGamePass = true
            showTab("Premium") -- Przejdź do zakładki Premium po zakupie
        else
            sendNotification("Universal Scripts", "Anulowano zakup wersji premium.")
        end
        checkGamePassStatus() -- Sprawdź status ponownie po zakończeniu transakcji
    end
})

-- Obsługa przeciągania przycisku HideButton
local dragStart
local startPos

HideButton.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragStart = input.Position
        startPos = HideButton.Position
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if dragStart and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
        local delta = input.Position - dragStart
        HideButton.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragStart = nil
    end
end)


-- Inicjalne sprawdzenie GamePassa i ustawienie widoczności przycisków
checkGamePassStatus()
showTab("Home") -- Domyślnie pokaż zakładkę Home przy starcie
