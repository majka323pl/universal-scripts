-- Załaduj Orion (upewnij się, że pochodzi z bezpiecznego repo)
local Orion = loadstring(game:HttpGet("https://raw.githubusercontent.com/jensonhirst/Orion/main/Orion.lua"))()

-- Główne GUI
local Window = Orion:MakeWindow({
    Name = "99 Nights i Forest Script",
    HidePremium = false,
    SaveConfig = true,
    ConfigFolder = "ForestScriptConfig"
})

-- Sekcja Automatyzacji
local AutoTab = Window:MakeTab({
    Name = "Auto Farm",
    Icon = "rbxassetid://4483345998",
    PremiumOnly = false
})

AutoTab:AddToggle({
    Name = "Auto Chop Wood",
    Default = false,
    Save = true,
    Flag = "AutoChop"
})

-- Sekcja ESP
local EspTab = Window:MakeTab({
    Name = "ESP",
    Icon = "rbxassetid://4483345998",
    PremiumOnly = false
})

EspTab:AddToggle({
    Name = "Enable ESP for Resources",
    Default = false,
    Save = true,
    Flag = "ESP"
})

-- Sekcja walki
local CombatTab = Window:MakeTab({
    Name = "Combat",
    Icon = "rbxassetid://4483345998",
    PremiumOnly = false
})

CombatTab:AddToggle({
    Name = "Kill Aura",
    Default = false,
    Save = true,
    Flag = "KillAura"
})

-- Pętle robocze
spawn(function()
    while task.wait(0.5) do
        local character = game.Players.LocalPlayer.Character
        if not character or not character.PrimaryPart then continue end
        
        -- Logika Auto Chopa
        if Orion.Flags.AutoChop.Value then
            local nearestTree, minDistance = nil, math.huge
            for _, tree in ipairs(workspace:GetDescendants()) do
                if tree.Name == "TreePart" and tree:IsA("BasePart") then
                    local distance = (tree.Position - character.PrimaryPart.Position).Magnitude
                    if distance < minDistance then
                        minDistance = distance
                        nearestTree = tree
                    end
                end
            end

            if nearestTree and minDistance < 50 then
                local clickDetector = nearestTree:FindFirstChildOfClass("ClickDetector")
                if clickDetector then
                    fireclickdetector(clickDetector)
                end
            end
        end

        -- Logika ESP
        if Orion.Flags.ESP.Value then
            for _, obj in ipairs(workspace:GetDescendants()) do
                if (obj.Name == "Chest" or obj.Name == "Resource") and not obj:FindFirstChild("Highlight") then
                    local hl = Instance.new("Highlight")
                    hl.FillColor = Color3.new(0, 1, 0)
                    hl.OutlineColor = Color3.new(1, 1, 1)
                    hl.Parent = obj
                end
            end
        else
            for _, obj in ipairs(workspace:GetDescendants()) do
                local hl = obj:FindFirstChild("Highlight")
                if hl then
                    hl:Destroy()
                end
            end
        end

        -- Logika Kill Aura
        if Orion.Flags.KillAura.Value then
            local nearestMob, minDistance = nil, math.huge
            for _, mob in ipairs(workspace:GetDescendants()) do
                local humanoid = mob:FindFirstChildOfClass("Humanoid")
                local primaryPart = mob:FindFirstChild("PrimaryPart")
                if humanoid and humanoid.Health > 0 and primaryPart then
                    local distance = (primaryPart.Position - character.PrimaryPart.Position).Magnitude
                    if distance < minDistance then
                        minDistance = distance
                        nearestMob = mob
                    end
                end
            end

            if nearestMob and minDistance < 10 then
                -- Wskazówka: Bezpośrednia zmiana HP na kliencie nie zadziała w większości gier.
                -- Ta część wymaga wysłania zdarzenia do serwera (np. poprzez RemoteEvent).
                local humanoid = nearestMob:FindFirstChildOfClass("Humanoid")
                if humanoid then
                    humanoid:TakeDamage(10)
                end
            end
        end
    end
end)

Orion:Init()
